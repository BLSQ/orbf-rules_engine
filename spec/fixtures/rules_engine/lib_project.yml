--- !ruby/object:Orbf::RulesEngine::Project
packages:
- &2 !ruby/object:Orbf::RulesEngine::Package
  matching_groupset_ext_ids: []
  rules:
  - &1 !ruby/object:Orbf::RulesEngine::Rule
    kind: activity
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: max_points
      expression: applicable
      comment: max_points
      frequency:
      single_mapping:
      activity_mappings:
      rule: *1
    - !ruby/object:Orbf::RulesEngine::Formula
      code: attributed_points
      expression: verified
      comment: attributed_points
      frequency:
      single_mapping:
      activity_mappings:
      rule: *1
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percentage_achieved
      expression: safe_div(verified,applicable)
      comment: percentage_achieved
      frequency:
      single_mapping:
      activity_mappings:
      rule: *1
    decision_tables: []
    package: *2
  - &3 !ruby/object:Orbf::RulesEngine::Rule
    kind: package
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: qualtity_score
      expression: safe_div(SUM(%{attributed_points_values}), SUM(%{max_points_values}))
      comment: quality_score
      frequency:
      single_mapping: d9mIxIx0OtD
      activity_mappings:
      rule: *3
      values_dependencies:
      - attributed_points_values
      - max_points_values
    decision_tables: []
    package: *2
  target_org_unit_group_ext_ids: []
  main_org_unit_group_ext_ids:
  - qp3vprL6Riq
  activities:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Aggregated Process of Care Score
    activity_code: hosp_qual_6
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: Aggregated Process of Care Score
      formula:
      kind: data_element
      ext_id: ctFJhNv6uXJ
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: applicable
      name: Aggregated Process of Care Score - applicable
      formula:
      kind: data_element
      ext_id: QSLhY5tUkYu
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Equipment and Supplies
    activity_code: hosp_qual_5
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: Equipment and Supplies
      formula:
      kind: data_element
      ext_id: IQ4gwgJtH6W
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: applicable
      name: Equipment and Supplies - applicable
      formula:
      kind: data_element
      ext_id: gfejUabfKFW
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Drugs Management
    activity_code: hosp_qual_4
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: Drugs Management
      formula:
      kind: data_element
      ext_id: SynAZGPJWtm
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: applicable
      name: Drugs Management - applicable
      formula:
      kind: data_element
      ext_id: JguUeTaKlQW
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Hygiene and Medical Waste Disposal
    activity_code: hosp_qual_3
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: Hygiene and Medical Waste Disposal
      formula:
      kind: data_element
      ext_id: CNmbkQrKQ4l
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: applicable
      name: Hygiene and Medical Waste Disposal - applicable
      formula:
      kind: data_element
      ext_id: K5PSDR4gmNM
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Human Resources for Health
    activity_code: hosp_qual_2
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: Human Resources for Health
      formula:
      kind: data_element
      ext_id: iCx3J6AhsHh
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: applicable
      name: Human Resources for Health - applicable
      formula:
      kind: data_element
      ext_id: Qra5xBch2Mj
  - !ruby/object:Orbf::RulesEngine::Activity
    name: General Management
    activity_code: hosp_qual_1
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: General Management
      formula:
      kind: data_element
      ext_id: DuAUVRHNjGo
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: applicable
      name: General Management - applicable
      formula:
      kind: data_element
      ext_id: NmXda02CApX
  kind: single
  code: hospital_quality
  frequency: quarterly
  groupset_ext_id:
  dataset_ext_ids:
  - gm259ceOo6p
  - ihOpt2gZ1mz
- &5 !ruby/object:Orbf::RulesEngine::Package
  matching_groupset_ext_ids: []
  rules:
  - &4 !ruby/object:Orbf::RulesEngine::Rule
    kind: activity
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: budget
      expression: verified
      comment: 'budget '
      frequency:
      single_mapping:
      activity_mappings:
      rule: *4
    decision_tables: []
    package: *5
  - &6 !ruby/object:Orbf::RulesEngine::Rule
    kind: package
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: total_quality_budget
      expression: SUM(%{budget_values})
      comment: total_quality_budget
      frequency:
      single_mapping:
      activity_mappings:
      rule: *6
      values_dependencies:
      - budget_values
    decision_tables: []
    package: *5
  target_org_unit_group_ext_ids: []
  main_org_unit_group_ext_ids:
  - qp3vprL6Riq
  activities:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: hospital_quality_budget
    activity_code: hospital_quality_budget
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: PBF - Verified - HOSPITAL_QUALITY_BUDGET hospital_quality_budget
      formula: '159678'
      kind: constant
      ext_id:
  kind: single
  code: hospital_budget
  frequency: quarterly
  groupset_ext_id:
  dataset_ext_ids: []
- &8 !ruby/object:Orbf::RulesEngine::Package
  matching_groupset_ext_ids: []
  rules:
  - &7 !ruby/object:Orbf::RulesEngine::Rule
    kind: activity
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: amount
      expression: verified * incentive
      comment: amount
      frequency:
      single_mapping:
      activity_mappings:
      rule: *7
    decision_tables: []
    package: *8
  - &9 !ruby/object:Orbf::RulesEngine::Rule
    kind: package
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: quantity_total_amount
      expression: SUM(%{amount_values})
      comment: quantity_total_amount
      frequency:
      single_mapping: kRVlKHCI1gB
      activity_mappings:
      rule: *9
      values_dependencies:
      - amount_values
    decision_tables: []
    package: *8
  target_org_unit_group_ext_ids: []
  main_org_unit_group_ext_ids:
  - qp3vprL6Riq
  activities:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Complicated and assisted pregnancy and delivery (including C-section)
    activity_code: hosp01
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: declared
      name: Claimed - Complicated and assisted pregnancy and delivery (including C-section)
      formula:
      kind: data_element
      ext_id: HhNSWBDeJi6
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: Verif - Complicated and assisted pregnancy and delivery (including C-section)
      formula:
      kind: data_element
      ext_id: Uxnm0lkeKXH
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: incentive
      name: PBF - Incentive - ACT_HOSP_QUANT_1 Complicated and assisted pregnancy
        and delivery (including C-section)
      formula: '17'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Normal deliveries of at-risk referrals
    activity_code: hosp02
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: declared
      name: Claimed - Normal deliveries of at-risk referrals
      formula:
      kind: data_element
      ext_id: urHekuEbCCL
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: Verif - Normal deliveries of at-risk referrals
      formula:
      kind: data_element
      ext_id: BsabCbsvzAY
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: incentive
      name: PBF - Incentive - ACT_HOSP_QUANT_2 Normal deliveries of at-risk referrals
      formula: '17'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Newborn referred for emergency neonatal care treatment
    activity_code: hosp04
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: declared
      name: 'Claimed - Newborn referred for emergency neonatal care treatment '
      formula:
      kind: data_element
      ext_id: eMVJI65I861
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: Verif - Newborn referred for emergency neonatal care treatment
      formula:
      kind: data_element
      ext_id: dW7fVXVyiQq
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: incentive
      name: PBF - Incentive - ACT_HOSP_QUANT_4 Newborn referred for emergency neonatal
        care treatment
      formula: '5'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Neonatal death audits carried out routinely according to the MNDSR
    activity_code: hosp03
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: declared
      name: Claimed - Neonatal death audits carried out routinely according to the
        MNDSR
      formula:
      kind: data_element
      ext_id: UrAhqBeYILo
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: verif - Neonatal death audits carried out routinely according to the MNDSR
      formula:
      kind: data_element
      ext_id: D9UOYqigaNJ
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: incentive
      name: PBF - Incentive - ACT_HOSP_QUANT_3 Neonatal death audits carried out routinely
        according to the MNDSR
      formula: '5'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Referred under-fives with fever
    activity_code: hosp05
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: declared
      name: Claimed - Referred under-fives with fever
      formula:
      kind: data_element
      ext_id: jQ11z4ljXQt
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: Verif - Referred under-fives with fever
      formula:
      kind: data_element
      ext_id: WJMCXpLg835
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: incentive
      name: PBF - Incentive - ACT_HOSP_QUANT_5 Referred under-fives with fever
      formula: '2.5'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Minor surgical intervention
    activity_code: hosp06
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: declared
      name: Claimed - Minor surgical intervention
      formula:
      kind: data_element
      ext_id: Yk6Alq6Pngq
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: Verif - Minor surgical intervention
      formula:
      kind: data_element
      ext_id: LGVHlygN6tV
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: incentive
      name: PBF - Incentive - ACT_HOSP_QUANT_6 Minor surgical intervention
      formula: '5'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Major surgery (including major trauma, excluding C-section)
    activity_code: hosp07
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: Verif - Major surgery (including major trauma excluding C-section)
      formula:
      kind: data_element
      ext_id: oedpCoECyO5
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: declared
      name: Claimed - Major surgery (including major trauma excluding C-section)
      formula:
      kind: data_element
      ext_id: s4VJPbrUpWk
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: incentive
      name: PBF - Incentive - ACT_HOSP_QUANT_7 Major surgery (including major trauma,
        excluding C-section)
      formula: '18'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Maternal death audits carried out routinely according to the National Technical
      Guidelines for Maternal & Newborn Death Surveillance and Response (MNDSR)
    activity_code: hosp08
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: declared
      name: Claimed - Maternal death audits carried out routinely according to the
        National Technical Guidelines for Maternal & Newborn Death Surveillance and
        Response (MNDSR)
      formula:
      kind: data_element
      ext_id: GELTVBu0W37
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: verif - Maternal death audits carried out routinely according to the National
        Technical Guidelines for Maternal & Newborn Death Surveillance and Response
        (MNDSR)
      formula:
      kind: data_element
      ext_id: HppsJPSxYpt
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: incentive
      name: PBF - Incentive - ACT_HOSP_QUANT_8 Maternal death audits carried out routinely
        according to the National Technical Guidelines for Maternal & Newborn Death
        Surveillance and Response (MNDSR)
      formula: '5'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Number of training sessions held by faculty for nurses, midwives, and physician
      assistants according to in-service curriculum and defined protocols
    activity_code: hosp09
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: incentive
      name: PBF - Incentive - ACT_HOSP_QUANT_9 Number of training sessions held by
        faculty for nurses, midwives, and physician assistants according to in-service
        curriculum and defined protocols
      formula: '50'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: declared
      name: Claimed - Number of training sessions held by faculty for nurses (midwives)
        and physician assistants according to in-service curriculum and defined protocols
      formula:
      kind: data_element
      ext_id: WfmiDu224eD
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: Verif - Number of training sessions held by faculty for nurses (midwives)
        and physician assistants according to in-service curriculum and defined protocols
      formula:
      kind: data_element
      ext_id: DCrEFCs84zH
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Number of nurses, midwives, and physician assistants that received specialized
      in-service training
    activity_code: hosp10
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: declared
      name: Claimed - Number of nurses (midwives) and physician assistants that received
        specialized in-service training
      formula:
      kind: data_element
      ext_id: O6nZtSBBRwN
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: verified
      name: Verif - Number of nurses (midwives) and physician assistants that received
        specialized in-service training
      formula:
      kind: data_element
      ext_id: x8lAzRowipa
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: incentive
      name: PBF - Incentive - ACT_HOSP_QUANT_10 Number of nurses, midwives, and physician
        assistants that received specialized in-service training
      formula: '10'
      kind: constant
      ext_id:
  kind: single
  code: hospital_quantity
  frequency: monthly
  groupset_ext_id:
  dataset_ext_ids:
  - Rdx39HWabU3
  - oeLgdOZ3nC9
- &11 !ruby/object:Orbf::RulesEngine::Package
  matching_groupset_ext_ids: []
  rules:
  - &10 !ruby/object:Orbf::RulesEngine::Rule
    kind: activity
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: actual_target
      expression: if(activity_type = 1, target, 100)
      comment: actual_target
      frequency:
      single_mapping:
      activity_mappings:
      rule: *10
      values_dependencies: []
      dependencies:
      - activity_type
      - target
    - !ruby/object:Orbf::RulesEngine::Formula
      code: act_cht_score
      expression: cht_score_zone_main_orgunit
      comment: act_cht_score (dummy to be used in upper rules)
      frequency:
      single_mapping:
      activity_mappings:
      rule: *10
      values_dependencies: []
      dependencies:
      - cht_score_zone_main_orgunit
    - !ruby/object:Orbf::RulesEngine::Formula
      code: reported
      expression: '1'
      comment: is the activity reported
      frequency:
      single_mapping:
      activity_mappings:
      rule: *10
      values_dependencies: []
      dependencies: []
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percent_overall
      expression: if(weight=0,0,(percent_weight/100)*percent_allowed)
      comment: "% Overall  [A x E]"
      frequency:
      single_mapping:
      activity_mappings:
        hf01: vQkUTSE9RRA
        hf02: waafdUg1zGw
        hf03: bBxwiJbSqlO
        hf04: ieRyvc5buIq
        hf05: TEAkoG7gxMe
        hf06: llX9ICvzqVO
        hf07: tBc4iF7XGjq
        hf08: mPruelGSIQ6
        hf09: G0vUgMkRIlT
      rule: *10
      values_dependencies: []
      dependencies:
      - weight
      - percent_weight
      - percent_allowed
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percent_allowed
      expression: if(min(percent_target_achieved,cap) < 75, 0, min(percent_target_achieved,cap)
        )
      comment: Allowed  [E]
      frequency:
      single_mapping:
      activity_mappings:
        hf01: v8jX1c5HRmg
        hf02: IMVgyQzJRTk
        hf03: H7TSsq3dPx2
        hf04: DUxBDyNjunN
        hf05: WNIy91Th458
        hf06: MSc21xQbHwg
        hf08: n6Cw286rurj
        hf09: MB4SSrqrXRM
        hf07: bVaOCN1KJa3
      rule: *10
      values_dependencies: []
      dependencies:
      - percent_target_achieved
      - cap
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percent_weight
      expression: safe_div(weight , hf_total_actual_weight )*100
      comment: percent_weight Column [A] of invoice
      frequency:
      single_mapping:
      activity_mappings:
        hf01: qfrYgOyxbVb
        hf02: DoKJ7IxeN3J
        hf03: ToGaV1VNAJz
        hf04: QsNtXcoIjoS
        hf05: wF9QdIjJIsk
        hf06: IeHTFiNJL81
        hf07: U2MivKbKakv
        hf08: IM8ZAh7utUq
        hf09: GYLx8x5l9aO
      rule: *10
      values_dependencies: []
      dependencies:
      - weight
      - hf_total_actual_weight
    - !ruby/object:Orbf::RulesEngine::Formula
      code: actual_weight
      expression: weight
      comment: actual_weight
      frequency:
      single_mapping:
      activity_mappings:
      rule: *10
      values_dependencies: []
      dependencies:
      - weight
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percent_target_achieved
      expression: safe_div(achieved, actual_target)*100
      comment: "% of Target Achieved [B x C]"
      frequency:
      single_mapping:
      activity_mappings:
        hf01: LEAIsySucru
        hf03: P84w8gua61y
        hf04: mkspPzuhXcz
        hf06: Y9J135Assj3
        hf07: mj21uXwG5Gm
        hf08: MOmGEM9Iphn
        hf02: UoJYpK4Ta2s
        hf05: c886Ncr92u8
        hf09: Zcv7iTUUrtO
      rule: *10
      values_dependencies: []
      dependencies:
      - achieved
      - actual_target
    - !ruby/object:Orbf::RulesEngine::Formula
      code: bonus_available_zone
      expression: bonus_available_zone_main_orgunit
      comment: bonus_available_zone
      frequency:
      single_mapping:
      activity_mappings:
      rule: *10
      values_dependencies: []
      dependencies:
      - bonus_available_zone_main_orgunit
    - !ruby/object:Orbf::RulesEngine::Formula
      code: actual_clinic_type
      expression: max(clinic_type,1)
      comment: Actual Clinic Type
      frequency:
      single_mapping:
      activity_mappings:
      rule: *10
      values_dependencies: []
      dependencies:
      - clinic_type
    - !ruby/object:Orbf::RulesEngine::Formula
      code: act_overall_performance_score
      expression: overall_score_zone_main_orgunit
      comment: act_overall_performance_score
      frequency:
      single_mapping:
      activity_mappings:
      rule: *10
      values_dependencies: []
      dependencies:
      - overall_score_zone_main_orgunit
    decision_tables: []
    package: *11
  - &12 !ruby/object:Orbf::RulesEngine::Rule
    kind: package
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_cht_overall_performance_score_values
      expression: MAX(%{act_overall_performance_score_values})
      comment: hf_cht_overall_performance_score_values from overall package
      frequency:
      single_mapping:
      activity_mappings:
      rule: *12
      values_dependencies:
      - act_overall_performance_score_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_cht_score_value
      expression: MAX(%{act_cht_score_values})
      comment: 'cht_score_value  '
      frequency:
      single_mapping:
      activity_mappings:
      rule: *12
      values_dependencies:
      - act_cht_score_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_bonus_earned_for_facility_management_community
      expression: hf_total_health_facility_bonus_earned - hf_bonus_earned_for_staff_payment
      comment: Bonus earned for facility management/community
      frequency:
      single_mapping: qPLsldZfmOy
      activity_mappings:
      rule: *12
      values_dependencies: []
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_bonus_earned_for_staff_payment
      expression: 0.65 * hf_total_health_facility_bonus_earned
      comment: Bonus earned for staff payment
      frequency:
      single_mapping: jwS856An2S7
      activity_mappings:
      rule: *12
      values_dependencies: []
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_total_health_facility_bonus_earned
      expression: cht_service_delivery_bonus_earned * (hf_relative_performance_score/100)
      comment: Total Health Facility Bonus earned
      frequency:
      single_mapping: hNqt0UCNyGd
      activity_mappings:
      rule: *12
      values_dependencies: []
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_bonus_available
      expression: cht_quarterly_bonus_available_for_hf * hf_weighted_clinic_type_indicator
      comment: Amount Available for the quarter (2. Bonus cal_facilities column F)
      frequency:
      single_mapping: qCMSgSDVund
      activity_mappings:
      rule: *12
      values_dependencies: []
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_cht_bonus_available_zone
      expression: MAX(%{bonus_available_zone_values})
      comment: hf_cht_bonus_available_zone
      frequency:
      single_mapping:
      activity_mappings:
      rule: *12
      values_dependencies:
      - bonus_available_zone_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_relative_performance_score
      expression: safe_div(hf_performance_score,cht_total_hf_performance_score) *
        100
      comment: Relative performance score
      frequency:
      single_mapping: ltKEuVv5RUc
      activity_mappings:
      rule: *12
      values_dependencies: []
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_clinic_type_indicators
      expression: hf_number_reported_indicators*hf_clinic_type
      comment: 'Clinic type X # Indicators'
      frequency:
      single_mapping: i3OwFflfUXU
      activity_mappings:
      rule: *12
      values_dependencies: []
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_clinic_type
      expression: max(%{actual_clinic_type_values})
      comment: Type of health clinic should be 1 or 2
      frequency:
      single_mapping:
      activity_mappings:
      rule: *12
      values_dependencies:
      - actual_clinic_type_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_total_weight
      expression: sum(%{percent_weight_values})
      comment: HF total weight column [A]
      frequency:
      single_mapping: NSTn1aBqlxp
      activity_mappings:
      rule: *12
      values_dependencies:
      - percent_weight_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_number_reported_indicators
      expression: sum(%{reported_values})
      comment: HF number of reported indicators
      frequency:
      single_mapping: W6icmNwjCTr
      activity_mappings:
      rule: *12
      values_dependencies:
      - reported_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_performance_score
      expression: sum(%{percent_overall_values})
      comment: HF total overall, sum up of [A*E]
      frequency:
      single_mapping: b85BBfaWf7G
      activity_mappings:
      rule: *12
      values_dependencies:
      - percent_overall_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_total_actual_weight
      expression: SUM(%{actual_weight_values})
      comment: hf_total_actual_weight
      frequency:
      single_mapping: GcTtDJlgqXs
      activity_mappings:
      rule: *12
      values_dependencies:
      - actual_weight_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_weighted_clinic_type_indicator
      expression: safe_div(hf_clinic_type_indicators,cht_total_clinic_type_indicator)
      comment: hf_weighted_clinic_type_indicator
      frequency:
      single_mapping: S6rwLZnicE6
      activity_mappings:
      rule: *12
      values_dependencies: []
    decision_tables: []
    package: *11
  - &13 !ruby/object:Orbf::RulesEngine::Rule
    kind: zone
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_bonus_earned_for_facility_management_community_values
      expression: cht_service_delivery_bonus_earned - cht_proportional_bonus_earned_for_staff_payment
      comment: Proportional allocation of bonus earned among PBF partners - Facility
        improvement/community partners (35%)
      frequency:
      single_mapping:
      activity_mappings:
      rule: *13
      values_dependencies: []
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_and_service_delivery_total_bonus_earned
      expression: cht_bonus_earned + cht_service_delivery_bonus_earned
      comment: Total bonus earned (1. Bonus allocation sheet)
      frequency:
      single_mapping:
      activity_mappings:
      rule: *13
      values_dependencies: []
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_service_delivery_bonus_earned
      expression: "if(cht_service_delivery_performance_score > 100 , \r\n    cht_quarterly_bonus_available_for_hf,\r\n
        \  (cht_service_delivery_performance_score /100) * cht_quarterly_bonus_available_for_hf)"
      comment: '1. Bonus allocation sheet : Service delivery bonus earned'
      frequency:
      single_mapping:
      activity_mappings:
      rule: *13
      values_dependencies: []
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_service_delivery_performance_score
      expression: MAX(%{hf_cht_overall_performance_score_values_values})
      comment: OVERALL FACILITIES PERFORMANCE
      frequency:
      single_mapping:
      activity_mappings:
      rule: *13
      values_dependencies:
      - hf_cht_overall_performance_score_values_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_performance_score
      expression: MAX(%{hf_cht_score_value_values})
      comment: 'CHT performance score 1. Bonus allocation sheet '
      frequency:
      single_mapping:
      activity_mappings:
      rule: *13
      values_dependencies:
      - hf_cht_score_value_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_total_hf_performance_score
      expression: SUM(%{hf_performance_score_values})
      comment: sum of hf's performance score
      frequency:
      single_mapping:
      activity_mappings:
      rule: *13
      values_dependencies:
      - hf_performance_score_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_total_clinic_type_indicator
      expression: sum(%{hf_clinic_type_indicators_values})
      comment: 'CHT total sum of Clinic type X # Indicators (2. Bonus cal_facilities
        Column E)'
      frequency:
      single_mapping:
      activity_mappings:
      rule: *13
      values_dependencies:
      - hf_clinic_type_indicators_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_quarterly_bonus_available_for_cht
      expression: 0.20 * cht_annual_bonus_available
      comment: Bonus available for CHT (20%) (1. Bonus allocation sheet)
      frequency:
      single_mapping:
      activity_mappings:
      rule: *13
      values_dependencies: []
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_quarterly_bonus_available_for_hf
      expression: 0.80 * cht_annual_bonus_available
      comment: Bonus available for Health facility (80%) (1. Bonus allocation sheet)
      frequency:
      single_mapping:
      activity_mappings:
      rule: *13
      values_dependencies: []
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_quarterly_bonus_available
      expression: cht_annual_bonus_available / 4
      comment: Total Bonus Available (1. Bonus allocation sheet)
      frequency:
      single_mapping:
      activity_mappings:
      rule: *13
      values_dependencies: []
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_annual_bonus_available
      expression: MAX(%{hf_cht_bonus_available_zone_values})
      comment: '1. Bonus allocation sheet : cell B5  '
      frequency:
      single_mapping:
      activity_mappings:
      rule: *13
      values_dependencies:
      - hf_cht_bonus_available_zone_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_proportional_bonus_earned_for_staff_payment
      expression: 0.65 * cht_service_delivery_bonus_earned
      comment: Proportional allocation of bonus earned among PBF partners - Facility
        staff (65%)
      frequency:
      single_mapping:
      activity_mappings:
      rule: *13
      values_dependencies: []
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_bonus_earned
      expression: "(cht_performance_score / 100) * cht_quarterly_bonus_available_for_cht"
      comment: CHT bonus earned (1. Bonus allocation sheet)
      frequency:
      single_mapping:
      activity_mappings:
      rule: *13
      values_dependencies: []
    decision_tables: []
    package: *11
  target_org_unit_group_ext_ids: []
  main_org_unit_group_ext_ids:
  - LtOlLRfT3BE
  activities:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of deliveries in health facility attended by skilled personnel"
    activity_code: hf01
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - HF01 [# and %] of deliveries in health facility attended
        by skilled personnel
      formula:
      kind: data_element
      ext_id: QBeXviw6Dti
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - HF01 [# and %] of deliveries in health facility attended
        by skilled personnel
      formula:
      kind: data_element
      ext_id: TGHDEpJOPL5
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cht_score
      name: PBF CHTNGO Administrative - Total Performance Score
      formula:
      kind: data_element
      ext_id: ou9WRHpnv8e
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: overall_score
      name: PBF PHC- HF Overall Performance score
      formula:
      kind: data_element
      ext_id: FC3nR54yGUx
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: bonus_available
      name: PBF CHTNGO - Annual Bonus available
      formula:
      kind: data_element
      ext_id: siwQkihDump
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: clinic_type
      name: PBF PHC - Type of Health Clinic
      formula:
      kind: data_element
      ext_id: WyxY3j5mQHF
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF01 [# and %] of deliveries in health facility attended by
        skilled personnel
      formula: '125'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF01 [# and %] of deliveries in health facility
        attended by skilled personnel
      formula: '1'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF01 [# and %] of deliveries in health facility attended
        by skilled personnel
      formula: '6'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of clients counselled for Family Planning"
    activity_code: hf02
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF PHC - Percentage of women of reproductive age who receive comprehensive
        FP information during visit - Target
      formula:
      kind: data_element
      ext_id: qdcIZVrsAtM
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF02 [# and %] of clients counselled for Family
        Planning
      formula: '1'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF02 [# and %] of clients counselled for Family Planning
      formula: '125'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF02 [# and %] of clients counselled for Family Planning
      formula: '5'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF PHC - Percentage of women of reproductive age who receive comprehensive
        FP information during visit - Achieved
      formula:
      kind: data_element
      ext_id: ss1jZkuH4P6
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of post partum women attending post natal care within 2 days
      after delivery by skilled birth attendants"
    activity_code: hf03
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - HF03 [# and %] of post partum women attending post natal
        care within 2 days  after delivery  by skilled birth attendants
      formula:
      kind: data_element
      ext_id: N51OjJ5T812
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF PHC - [# and] % of women that receive PNC after delivery within  24
        hours of childbirth by skilled birth attendant - Achieved
      formula:
      kind: data_element
      ext_id: yptYldr6oqT
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF03 [# and %] of post partum women attending post
        natal care within 2 days after delivery by skilled birth attendants
      formula: '1'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF03 [# and %] of post partum women attending post natal care
        within 2 days after delivery by skilled birth attendants
      formula: '125'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF03 [# and %] of post partum women attending post natal
        care within 2 days after delivery by skilled birth attendants
      formula: '5'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of Pregnant women Post-test counsel for HIV "
    activity_code: hf04
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - HF04 [# and %] of Pregnant women Post-test counsel for
        HIV
      formula:
      kind: data_element
      ext_id: J7vejrdIE8d
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - HF04 [# and %] of Pregnant women Post-test counsel for
        HIV
      formula:
      kind: data_element
      ext_id: E7TAIbhqvDM
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF04 [# and %] of Pregnant women Post-test counsel
        for HIV
      formula: '1'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF04 [# and %] of Pregnant women Post-test counsel for HIV
      formula: '125'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF04 [# and %] of Pregnant women Post-test counsel for
        HIV
      formula: '5'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of children under 1 year of age fully immunized"
    activity_code: hf05
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - HF05 [# and %] of children under 1 year of age fully immunized
      formula:
      kind: data_element
      ext_id: jAMzoRuKoBv
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - HF05 [# and %] of children under 1 year of age fully
        immunized
      formula:
      kind: data_element
      ext_id: a4LeN1BCmde
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF05 [# and %] of children under 1 year of age fully
        immunized
      formula: '1'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF05 [# and %] of children under 1 year of age fully immunized
      formula: '100'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF05 [# and %] of children under 1 year of age fully immunized
      formula: '5'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of pregnant women who took  3rd dose of IPT for malaria"
    activity_code: hf06
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - HF06 [# and %] of pregnant women who took  3rd dose of
        IPT for malaria
      formula:
      kind: data_element
      ext_id: DLy5y9SdPMH
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF PHC - [# and] % of pregnant women took with 2nd dose of IPT for malaria
        - Achieved
      formula:
      kind: data_element
      ext_id: muU9X9Cj6hD
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF06 [# and %] of pregnant women who took  3rd dose
        of IPT for malaria
      formula: '1'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF06 [# and %] of pregnant women who took  3rd dose of IPT
        for malaria
      formula: '125'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF06 [# and %] of pregnant women who took  3rd dose of
        IPT for malaria
      formula: '6'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "% score obtained by the facility on the quality assessment"
    activity_code: hf07
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - HF07 % score obtained by the facility on the quality
        assessment
      formula:
      kind: data_element
      ext_id: xBhlvjlirqP
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF07 % score obtained by the facility on the quality
        assessment
      formula: '2'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF07 % score obtained by the facility on the quality assessment
      formula: '125'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF07 % score obtained by the facility on the quality assessment
      formula: '10'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Number of notified cases of all forms of TB
    activity_code: hf08
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - HF08 Number of notified cases of all forms of TB
      formula:
      kind: data_element
      ext_id: cEe5dLaIrJy
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - HF08 Number of notified cases of all forms of TB
      formula:
      kind: data_element
      ext_id: c3mDrrRuiQx
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF08 Number of notified cases of all forms of TB
      formula: '1'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF08 Number of notified cases of all forms of TB
      formula: '100'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF08 Number of notified cases of all forms of TB
      formula: '7'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "% score obtained by the facility on the client satisfaction survey"
    activity_code: hf09
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF PHC - Number of new smear positive TB cases reported during the quarter
        - Target
      formula:
      kind: data_element
      ext_id: M1ZBJtiM8zB
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF PHC - Number of new smear positive TB cases reported during the quarter
        - Achieved
      formula:
      kind: data_element
      ext_id: QFxm7pU8v5c
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF09 % score obtained by the facility on the client satisfaction
        survey
      formula: '100'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF09 % score obtained by the facility on the client satisfaction
        survey
      formula: '5'
      kind: constant
      ext_id:
  kind: zone
  code: pbf__hf_performance
  frequency: quarterly
  groupset_ext_id: vsDQ43ozxG1
  dataset_ext_ids:
  - Fbl2mVLYDWm
  - ezcDugHAJnu
  - IwrDre28Kyn
  - yknV2rDuLgZ
  - LDtaPBR5Kok
  - raUhXqxEGiV
  states: !ruby/object:Set
    hash:
      achieved: true
      target: true
      cht_score: true
      overall_score: true
      bonus_available: true
      clinic_type: true
      cap: true
      activity_type: true
      weight: true
- &15 !ruby/object:Orbf::RulesEngine::Package
  matching_groupset_ext_ids: []
  rules:
  - &14 !ruby/object:Orbf::RulesEngine::Rule
    kind: activity
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percent_weight
      expression: safe_div(weight , hfo_total_actual_weight )*100
      comment: percent_weight Column [A] of invoice
      frequency:
      single_mapping:
      activity_mappings:
      rule: *14
      values_dependencies: []
      dependencies:
      - weight
      - hfo_total_actual_weight
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percent_target_achieved
      expression: safe_div(achieved, target)*100
      comment: "% of Target Achieved [B x C]"
      frequency:
      single_mapping:
      activity_mappings:
      rule: *14
      values_dependencies: []
      dependencies:
      - achieved
      - target
    - !ruby/object:Orbf::RulesEngine::Formula
      code: actual_weight
      expression: weight
      comment: Actual weight
      frequency:
      single_mapping:
      activity_mappings:
      rule: *14
      values_dependencies: []
      dependencies:
      - weight
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percent_allowed
      expression: if(min(percent_target_achieved,cap) < 75, 0, min(percent_target_achieved,cap)
        )
      comment: Allowed [E]
      frequency:
      single_mapping:
      activity_mappings:
      rule: *14
      values_dependencies: []
      dependencies:
      - percent_target_achieved
      - cap
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percent_overall
      expression: if(weight=0,0,(percent_weight/100)*percent_allowed)
      comment: "% Overall  [A x E]"
      frequency:
      single_mapping:
      activity_mappings:
      rule: *14
      values_dependencies: []
      dependencies:
      - weight
      - percent_weight
      - percent_allowed
    - !ruby/object:Orbf::RulesEngine::Formula
      code: actual_clinic_type
      expression: safe_div(clinic_type, org_units_sum_if_count )
      comment: Actual Clinic Type
      frequency:
      single_mapping:
      activity_mappings:
      rule: *14
      values_dependencies: []
      dependencies:
      - clinic_type
      - org_units_sum_if_count
    decision_tables: []
    package: *15
  - &16 !ruby/object:Orbf::RulesEngine::Rule
    kind: package
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hfo_total_actual_weight
      expression: SUM(%{actual_weight_values})
      comment: Total weight
      frequency:
      single_mapping:
      activity_mappings:
      rule: *16
      values_dependencies:
      - actual_weight_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hfo_total_performance_score
      expression: SUM(%{percent_overall_values})
      comment: Sum of % Overall performance score [A x E]
      frequency:
      single_mapping: FC3nR54yGUx
      activity_mappings:
      rule: *16
      values_dependencies:
      - percent_overall_values
    decision_tables: []
    package: *15
  - !ruby/object:Orbf::RulesEngine::Rule
    kind: entities_aggregation
    formulas: []
    decision_tables:
    - !ruby/object:Orbf::RulesEngine::DecisionTable
      headers: &17
      - in:groupset_code_type
      - out:sum_if
      rules:
      - !ruby/object:Orbf::RulesEngine::DecisionRule
        headers: *17
        index: 0
        row:
          in:groupset_code_type: pbf_chts
          out:sum_if: 'false'
        headers_by_type:
          'in:':
          - in:groupset_code_type
          'out:':
          - out:sum_if
      - !ruby/object:Orbf::RulesEngine::DecisionRule
        headers: *17
        index: 1
        row:
          in:groupset_code_type: "*"
          out:sum_if: 'true'
        headers_by_type:
          'in:':
          - in:groupset_code_type
          'out:':
          - out:sum_if
    package: *15
  target_org_unit_group_ext_ids: []
  main_org_unit_group_ext_ids:
  - LtOlLRfT3BE
  activities:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of deliveries in health facility attended by skilled personnel"
    activity_code: hf01
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - HF01 [# and %] of deliveries in health facility attended
        by skilled personnel
      formula:
      kind: data_element
      ext_id: QBeXviw6Dti
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - HF01 [# and %] of deliveries in health facility attended
        by skilled personnel
      formula:
      kind: data_element
      ext_id: TGHDEpJOPL5
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: clinic_type
      name: PBF PHC - Type of Health Clinic
      formula:
      kind: data_element
      ext_id: WyxY3j5mQHF
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF01 [# and %] of deliveries in health facility attended by
        skilled personnel
      formula: '125'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF01 [# and %] of deliveries in health facility attended
        by skilled personnel
      formula: '6'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of clients counselled for Family Planning"
    activity_code: hf02
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF PHC - Percentage of women of reproductive age who receive comprehensive
        FP information during visit - Target
      formula:
      kind: data_element
      ext_id: qdcIZVrsAtM
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF02 [# and %] of clients counselled for Family Planning
      formula: '125'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF02 [# and %] of clients counselled for Family Planning
      formula: '5'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF PHC - Percentage of women of reproductive age who receive comprehensive
        FP information during visit - Achieved
      formula:
      kind: data_element
      ext_id: ss1jZkuH4P6
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of pregnant women who took  3rd dose of IPT for malaria"
    activity_code: hf06
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - HF06 [# and %] of pregnant women who took  3rd dose of
        IPT for malaria
      formula:
      kind: data_element
      ext_id: DLy5y9SdPMH
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF PHC - [# and] % of pregnant women took with 2nd dose of IPT for malaria
        - Achieved
      formula:
      kind: data_element
      ext_id: muU9X9Cj6hD
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF06 [# and %] of pregnant women who took  3rd dose of IPT
        for malaria
      formula: '125'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF06 [# and %] of pregnant women who took  3rd dose of
        IPT for malaria
      formula: '6'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of Pregnant women Post-test counsel for HIV "
    activity_code: hf04
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - HF04 [# and %] of Pregnant women Post-test counsel for
        HIV
      formula:
      kind: data_element
      ext_id: J7vejrdIE8d
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - HF04 [# and %] of Pregnant women Post-test counsel for
        HIV
      formula:
      kind: data_element
      ext_id: E7TAIbhqvDM
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF04 [# and %] of Pregnant women Post-test counsel for HIV
      formula: '125'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF04 [# and %] of Pregnant women Post-test counsel for
        HIV
      formula: '5'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "% score obtained by the facility on the quality assessment"
    activity_code: hf07
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - HF07 % score obtained by the facility on the quality
        assessment
      formula:
      kind: data_element
      ext_id: xBhlvjlirqP
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF07 % score obtained by the facility on the quality assessment
      formula: '125'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF07 % score obtained by the facility on the quality assessment
      formula: '10'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Number of notified cases of all forms of TB
    activity_code: hf08
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - HF08 Number of notified cases of all forms of TB
      formula:
      kind: data_element
      ext_id: cEe5dLaIrJy
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - HF08 Number of notified cases of all forms of TB
      formula:
      kind: data_element
      ext_id: c3mDrrRuiQx
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF08 Number of notified cases of all forms of TB
      formula: '100'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF08 Number of notified cases of all forms of TB
      formula: '7'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of children under 1 year of age fully immunized"
    activity_code: hf05
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - HF05 [# and %] of children under 1 year of age fully immunized
      formula:
      kind: data_element
      ext_id: jAMzoRuKoBv
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - HF05 [# and %] of children under 1 year of age fully
        immunized
      formula:
      kind: data_element
      ext_id: a4LeN1BCmde
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF05 [# and %] of children under 1 year of age fully immunized
      formula: '100'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF05 [# and %] of children under 1 year of age fully immunized
      formula: '5'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of post partum women attending post natal care within 2 days
      after delivery by skilled birth attendants"
    activity_code: hf03
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - HF03 [# and %] of post partum women attending post natal
        care within 2 days  after delivery  by skilled birth attendants
      formula:
      kind: data_element
      ext_id: N51OjJ5T812
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF PHC - [# and] % of women that receive PNC after delivery within  24
        hours of childbirth by skilled birth attendant - Achieved
      formula:
      kind: data_element
      ext_id: yptYldr6oqT
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF03 [# and %] of post partum women attending post natal care
        within 2 days after delivery by skilled birth attendants
      formula: '125'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF03 [# and %] of post partum women attending post natal
        care within 2 days after delivery by skilled birth attendants
      formula: '5'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "% score obtained by the facility on the client satisfaction survey"
    activity_code: hf09
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF PHC - Number of new smear positive TB cases reported during the quarter
        - Target
      formula:
      kind: data_element
      ext_id: M1ZBJtiM8zB
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF PHC - Number of new smear positive TB cases reported during the quarter
        - Achieved
      formula:
      kind: data_element
      ext_id: QFxm7pU8v5c
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - HF09 % score obtained by the facility on the client satisfaction
        survey
      formula: '100'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - HF09 % score obtained by the facility on the client satisfaction
        survey
      formula: '5'
      kind: constant
      ext_id:
  kind: subcontract
  code: pbf__hf_overall_performance
  frequency: quarterly
  groupset_ext_id: vsDQ43ozxG1
  dataset_ext_ids:
  - lGCAjNiE7O7
  - NV8SkzLjtqd
  - JDDYBYNt0kh
  states: !ruby/object:Set
    hash:
      achieved: true
      target: true
      clinic_type: true
      cap: true
      weight: true
- &19 !ruby/object:Orbf::RulesEngine::Package
  matching_groupset_ext_ids: []
  rules:
  - &18 !ruby/object:Orbf::RulesEngine::Rule
    kind: activity
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: quarterly_target
      expression: "if(activity_type == 1, \r\nSUM(%{monthly_target_todo_current_quarter_values}),\r\nAVG(%{monthly_target_todo_current_quarter_values})\r\n)"
      comment: Quarterly Target
      frequency: quarterly
      single_mapping:
      activity_mappings:
        hf01: TGHDEpJOPL5
        hf03: N51OjJ5T812
        hf04: E7TAIbhqvDM
        hf05: jAMzoRuKoBv
        hf08: cEe5dLaIrJy
        hf02: c6tPsclqW3l
      rule: *18
      values_dependencies:
      - monthly_target_todo_current_quarter_values
      - monthly_target_todo_current_quarter_values
      dependencies:
      - activity_type
    - !ruby/object:Orbf::RulesEngine::Formula
      code: quarterly_achieved
      expression: "if(activity_type == 1, \r\nSUM(%{monthly_achieved_current_quarter_values}),\r\nAVG(%{monthly_achieved_current_quarter_values})\r\n)"
      comment: Quarterly achieved
      frequency: quarterly
      single_mapping:
      activity_mappings:
        hf01: QBeXviw6Dti
        hf02: ss1jZkuH4P6
        hf03: yptYldr6oqT
        hf04: J7vejrdIE8d
        hf05: a4LeN1BCmde
        hf08: c3mDrrRuiQx
        hf07: xBhlvjlirqP
      rule: *18
      values_dependencies:
      - monthly_achieved_current_quarter_values
      - monthly_achieved_current_quarter_values
      dependencies:
      - activity_type
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percentage_difference
      expression: safe_div(ABS(monthly_declared - monthly_verified ), monthly_verified)
        * 100
      comment: Percentage difference
      frequency:
      single_mapping:
      activity_mappings:
        hf01: DFdrv8eauzs
        hf05: yzLVfX9rGoq
        hf02: EIJGOgMpJ8K
        hf03: aKdQsNGvlX2
        hf04: L4LzdwXuRWg
        hf07: bQloWzwfnB1
        hf08: fyCA1AMGqVB
      rule: *18
      values_dependencies: []
      dependencies:
      - monthly_declared
      - monthly_verified
    - !ruby/object:Orbf::RulesEngine::Formula
      code: monthly_achieved
      expression: "if(activity_type == 1, \r\nif(percentage_difference < 10, monthly_verified
        , 0 ),\r\nmonthly_verified)"
      comment: Monthly Achieved
      frequency:
      single_mapping:
      activity_mappings:
        hf01: GDdVg4Pn8VL
        hf03: d21bHMVyed4
        hf05: oErT9hZi6mm
        hf07: p2vqLUR9F3Y
        hf08: dF7pJHqBjig
        hf02: fGiqWzUoz4F
        hf04: g5s4W7wUWEt
      rule: *18
      values_dependencies: []
      dependencies:
      - activity_type
      - percentage_difference
      - monthly_verified
    - !ruby/object:Orbf::RulesEngine::Formula
      code: monthly_target_todo
      expression: monthly_target
      comment: monthly_target_todo
      frequency: monthly
      single_mapping:
      activity_mappings:
      rule: *18
      values_dependencies: []
      dependencies:
      - monthly_target
    decision_tables: []
    package: *19
  target_org_unit_group_ext_ids: []
  main_org_unit_group_ext_ids:
  - LtOlLRfT3BE
  activities:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of deliveries in health facility attended by skilled personnel"
    activity_code: hf01
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_declared
      name: PBF - Monthly Declared - HF01 [# and %] of deliveries in health facility
        attended by skilled personnel
      formula:
      kind: data_element
      ext_id: aVXlNCkqMGH
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_verified
      name: PBF - Monthly Verified - HF01 [# and %] of deliveries in health facility
        attended by skilled personnel
      formula:
      kind: data_element
      ext_id: RRvsMfAcr5W
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_target
      name: PBF - MTarget - HF01 [# and %] of deliveries in health facility attended
        by skilled personnel
      formula:
      kind: data_element
      ext_id: Fu5FCr8IhNf
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF01 [# and %] of deliveries in health facility
        attended by skilled personnel
      formula: '1'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of clients counselled for Family Planning"
    activity_code: hf02
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_declared
      name: PBF - Monthly Declared - HF02 [# and %] of clients counselled for Family
        Planning
      formula:
      kind: data_element
      ext_id: v9lh5BvCfnH
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_target
      name: PBF - MTarget - HF02 [# and %] of clients counselled for Family Planning
      formula:
      kind: data_element
      ext_id: dZPcNBgtbdM
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_verified
      name: PBF - Monthly Verified - HF02 [# and %] of clients counselled for Family
        Planning
      formula:
      kind: data_element
      ext_id: cQiC0T5A13D
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF02 [# and %] of clients counselled for Family
        Planning
      formula: '1'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of post partum women attending post natal care within 2 days
      after delivery by skilled birth attendants"
    activity_code: hf03
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_target
      name: PBF - MTarget - HF03 [# and %] of post partum women attending post natal
        care within 2 days  after delivery  by skilled birth attendants
      formula:
      kind: data_element
      ext_id: vrr2BlT2XOf
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_verified
      name: PBF - Monthly Verified - HF03 [# and %] of post partum women attending
        post natal care within 2 days  after delivery  by skilled birth attendants
      formula:
      kind: data_element
      ext_id: r4PPZ55miax
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_declared
      name: PBF - MDeclared - HF03 [# and %] of post partum women attending post natal
        care within 2 days after delivery by skilled birth attendants
      formula:
      kind: data_element
      ext_id: GWfXeCy5Dm6
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF03 [# and %] of post partum women attending post
        natal care within 2 days after delivery by skilled birth attendants
      formula: '1'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of Pregnant women Post-test counsel for HIV "
    activity_code: hf04
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_declared
      name: PBF - Monthly Declared - HF04 [# and %] of Pregnant women Post-test counsel
        for HIV
      formula:
      kind: data_element
      ext_id: uYTcdXjSZvS
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_target
      name: PBF - MTarget - HF04 [# and %] of Pregnant women Post-test counsel for
        HIV
      formula:
      kind: data_element
      ext_id: vWk5BPvxaMT
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_verified
      name: PBF - Monthly Verified - HF04 [# and %] of Pregnant women Post-test counsel
        for HIV
      formula:
      kind: data_element
      ext_id: uqIavCuccrl
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF04 [# and %] of Pregnant women Post-test counsel
        for HIV
      formula: '1'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of children under 1 year of age fully immunized"
    activity_code: hf05
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_target
      name: PBF - MTarget - HF05 [# and %] of children under 1 year of age fully immunized
      formula:
      kind: data_element
      ext_id: KaklAgZwi2E
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_verified
      name: PBF - Monthly Verified - HF05 [# and %] of children under 1 year of age
        fully immunized
      formula:
      kind: data_element
      ext_id: nucrRJ0J0gD
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_declared
      name: PBF - Monthly Declared - HF05 [# and %] of children under 1 year of age
        fully immunized
      formula:
      kind: data_element
      ext_id: pq31qHDeSHh
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF05 [# and %] of children under 1 year of age fully
        immunized
      formula: '1'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "% score obtained by the facility on the quality assessment"
    activity_code: hf07
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_verified
      name: PBF - HF QoC - Hf monthly qualtity score
      formula:
      kind: data_element
      ext_id: wWVxNJO1ZLh
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF07 % score obtained by the facility on the quality
        assessment
      formula: '2'
      kind: constant
      ext_id:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Number of notified cases of all forms of TB
    activity_code: hf08
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_declared
      name: PBF - Monthly Declared - HF08 Number of notified cases of all forms  of
        TB
      formula:
      kind: data_element
      ext_id: quWQKNX9tt6
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_verified
      name: PBF - Monthly Verified - HF08 Number of notified cases of all forms  of
        TB
      formula:
      kind: data_element
      ext_id: l34qwnO8Lvi
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: monthly_target
      name: PBF - MTarget - HF08 Number of notified cases of all forms of TB
      formula:
      kind: data_element
      ext_id: B91I0MXfe3U
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: activity_type
      name: PBF - Activity Type - HF08 Number of notified cases of all forms of TB
      formula: '1'
      kind: constant
      ext_id:
  kind: zone
  code: pbf__hf_performance_monthly
  frequency: monthly
  groupset_ext_id: vsDQ43ozxG1
  dataset_ext_ids:
  - Jkc7qMvsLSP
  - BaYWNrY7e1J
  - S7B7icLlQvH
  states: !ruby/object:Set
    hash:
      monthly_declared: true
      monthly_verified: true
      monthly_target: true
      activity_type: true
- &21 !ruby/object:Orbf::RulesEngine::Package
  matching_groupset_ext_ids: []
  rules:
  - &20 !ruby/object:Orbf::RulesEngine::Rule
    kind: package
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: hf_monthly_quality_score
      expression: safe_div(SUM(%{attributed_points_values}), SUM(%{max_points_values}))
        * 100
      comment: HF MonthlyQuality Score
      frequency:
      single_mapping: wWVxNJO1ZLh
      activity_mappings:
      rule: *20
      values_dependencies:
      - attributed_points_values
      - max_points_values
    decision_tables: []
    package: *21
  - &22 !ruby/object:Orbf::RulesEngine::Rule
    kind: activity
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percentage_achieved
      expression: safe_div(attributed_points,max_points) * 100
      comment: Percentage achieved
      frequency:
      single_mapping:
      activity_mappings:
      rule: *22
      values_dependencies: []
      dependencies:
      - attributed_points
      - max_points
    - !ruby/object:Orbf::RulesEngine::Formula
      code: attributed_points
      expression: acquired_points
      comment: attributed_points
      frequency:
      single_mapping:
      activity_mappings:
      rule: *22
      values_dependencies: []
      dependencies:
      - acquired_points
    - !ruby/object:Orbf::RulesEngine::Formula
      code: max_points
      expression: possible_points
      comment: Max Points
      frequency:
      single_mapping:
      activity_mappings:
      rule: *22
      values_dependencies: []
      dependencies:
      - possible_points
    decision_tables: []
    package: *21
  target_org_unit_group_ext_ids: []
  main_org_unit_group_ext_ids:
  - LtOlLRfT3BE
  activities:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Administration
    activity_code: qochf01
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: acquired_points
      name: District Admin - total acquired score
      formula:
      kind: data_element
      ext_id: M19mxheizXU
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: possible_points
      name: District ADM - Total of available points
      formula:
      kind: data_element
      ext_id: tpXljZLddqC
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Antenatal Care
    activity_code: qochf02
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: acquired_points
      name: District ANC - total acquired score
      formula:
      kind: data_element
      ext_id: egjeNpHj5Uz
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: possible_points
      name: District ANC - Total of available points
      formula:
      kind: data_element
      ext_id: OLDQO1uz2jH
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Family Planning
    activity_code: qochf03
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: acquired_points
      name: District FP - total acquired score
      formula:
      kind: data_element
      ext_id: JBpVCQxBdw8
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: possible_points
      name: District FP - Total of available points
      formula:
      kind: data_element
      ext_id: AEjgTD01GC8
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Normal Labor & Delivery
    activity_code: qochf04
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: acquired_points
      name: 'District NLD - total acquired score '
      formula:
      kind: data_element
      ext_id: ci6YEHUPckr
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: possible_points
      name: District NLD - Total of available points
      formula:
      kind: data_element
      ext_id: zQ51dU9KtAr
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Postpartum
    activity_code: qochf05
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: acquired_points
      name: District PP - total acquired score
      formula:
      kind: data_element
      ext_id: usSLQgITP2i
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: possible_points
      name: District PP - Total of available points
      formula:
      kind: data_element
      ext_id: QVetDZPmJRv
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Obstetric Complication
    activity_code: qochf06
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: acquired_points
      name: 'District OC - total acquired score '
      formula:
      kind: data_element
      ext_id: z2T4M8XinNS
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: possible_points
      name: District OC - Total of available points
      formula:
      kind: data_element
      ext_id: oLhCFRdpQ7z
  - !ruby/object:Orbf::RulesEngine::Activity
    name: EPI
    activity_code: qochf07
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: acquired_points
      name: 'District EPI - total acquired score '
      formula:
      kind: data_element
      ext_id: GChOe1GpN06
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: possible_points
      name: District EPI - Total of available points
      formula:
      kind: data_element
      ext_id: QcIrfyD4A7Y
  - !ruby/object:Orbf::RulesEngine::Activity
    name: HIV
    activity_code: qochf09
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: acquired_points
      name: 'District HIV - total acquired score '
      formula:
      kind: data_element
      ext_id: kYEKsIm5iBL
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: possible_points
      name: District HIV - Total of available points
      formula:
      kind: data_element
      ext_id: IUZzPZOG6Ob
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Malaria
    activity_code: qochf10
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: acquired_points
      name: 'District Malaria - total acquired score '
      formula:
      kind: data_element
      ext_id: bTqQS6cSrfH
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: possible_points
      name: District Malaria - Total of available points
      formula:
      kind: data_element
      ext_id: AB7jZdhtPvZ
  - !ruby/object:Orbf::RulesEngine::Activity
    name: IPC
    activity_code: qochf11
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: acquired_points
      name: District IPC - total acquired score
      formula:
      kind: data_element
      ext_id: HENPZJaM1ve
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: possible_points
      name: District IPC - Total of available points
      formula:
      kind: data_element
      ext_id: lZqhUZFoWZh
  - !ruby/object:Orbf::RulesEngine::Activity
    name: TB
    activity_code: qochf08
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: acquired_points
      name: District TB - total acquired score
      formula:
      kind: data_element
      ext_id: yQ8hoIxIrhu
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: possible_points
      name: District TB - Total of available points
      formula:
      kind: data_element
      ext_id: DVY7JCzwW1O
  kind: zone
  code: jiss_district__hf_qoc
  frequency: monthly
  groupset_ext_id: vsDQ43ozxG1
  dataset_ext_ids:
  - luFDYlyMBxZ
  - Htk3bYOyhi5
  states: !ruby/object:Set
    hash:
      acquired_points: true
      possible_points: true
- &24 !ruby/object:Orbf::RulesEngine::Package
  matching_groupset_ext_ids: []
  rules:
  - &23 !ruby/object:Orbf::RulesEngine::Rule
    kind: activity
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percent_overall
      expression: "(percent_weight/100)*(percent_allowed/100)*100"
      comment: "% Overall performance score [A x E]"
      frequency:
      single_mapping:
      activity_mappings:
      rule: *23
      values_dependencies: []
      dependencies:
      - percent_weight
      - percent_allowed
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percent_allowed
      expression: if(min(percent_target_achieved,cap) < 75, 0, min(percent_target_achieved,cap)
        )
      comment: Allowed [E]
      frequency:
      single_mapping:
      activity_mappings:
      rule: *23
      values_dependencies: []
      dependencies:
      - percent_target_achieved
      - cap
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percent_target_achieved
      expression: safe_div(achieved,target)*100
      comment: "% of Target Achieved [B x C]"
      frequency:
      single_mapping:
      activity_mappings:
      rule: *23
      values_dependencies: []
      dependencies:
      - achieved
      - target
    - !ruby/object:Orbf::RulesEngine::Formula
      code: percent_weight
      expression: safe_div(actual_weight,cht_total_weight)*100
      comment: "% Weight  [A]"
      frequency:
      single_mapping:
      activity_mappings:
      rule: *23
      values_dependencies: []
      dependencies:
      - actual_weight
      - cht_total_weight
    - !ruby/object:Orbf::RulesEngine::Formula
      code: actual_weight
      expression: weight
      comment: weight
      frequency:
      single_mapping:
      activity_mappings:
      rule: *23
      values_dependencies: []
      dependencies:
      - weight
    decision_tables: []
    package: *24
  - &25 !ruby/object:Orbf::RulesEngine::Rule
    kind: package
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_total_performance_score
      expression: SUM(%{percent_overall_values})
      comment: Sum of % Overall performance score [A x E]
      frequency:
      single_mapping: ou9WRHpnv8e
      activity_mappings:
      rule: *25
      values_dependencies:
      - percent_overall_values
    - !ruby/object:Orbf::RulesEngine::Formula
      code: cht_total_weight
      expression: SUM(%{actual_weight_values})
      comment: Total weight
      frequency:
      single_mapping:
      activity_mappings:
      rule: *25
      values_dependencies:
      - actual_weight_values
    decision_tables: []
    package: *24
  target_org_unit_group_ext_ids: []
  main_org_unit_group_ext_ids:
  - LtOlLRfT3BE
  activities:
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and] % of facilities with no stock-out of tracer drugs during the quarter
      (amoxicillin, cotrimoxazole, paracetamol, ORS, iron folate, ACT) [0 day of stock
      out]"
    activity_code: cht01
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - CHTNGO01 [# and] % of facilities with no stock-out of tracer
        drugs during the quarter (amoxicillin, cotrimoxazole, paracetamol, ORS, iron
        folate, ACT) [0 day of stock out]
      formula: '100'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - CHTNGO01 [# and] % of facilities with no stock-out of tracer
        drugs during the quarter (amoxicillin, cotrimoxazole, paracetamol, ORS, iron
        folate, ACT) [0 day of stock out]
      formula: '10'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - CHTNGO01 [# and] % of facilities with no stock-out of tracer
        drugs during the quarter (amoxicillin, cotrimoxazole, paracetamol, ORS, iron
        folate, ACT) [0 day of stock out]
      formula:
      kind: data_element
      ext_id: jzQOMZpDaxJ
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - CHTNGO01 [# and] % of facilities with no stock-out of
        tracer drugs during the quarter (amoxicillin, cotrimoxazole, paracetamol,
        ORS, iron folate, ACT) [0 day of stock out]
      formula:
      kind: data_element
      ext_id: Z1rgdJcMiov
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of facilities that held at least three HFDC meetings"
    activity_code: cht04
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - CHTNGO04 [# and %] of facilities that held at least three
        HFDC meetings
      formula: '100'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - CHTNGO04 [# and %] of facilities that held at least three
        HFDC meetings
      formula: '8'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - CHTNGO04 [# and %] of facilities that held at least three
        HFDC meetings
      formula:
      kind: data_element
      ext_id: w797yLCpWGi
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - CHTNGO04 [# and %] of facilities that held at least three
        HFDC meetings
      formula:
      kind: data_element
      ext_id: RHBS4771vki
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and] % of facilities submitted timely and complete HMIS reports to the
      MOH during the quarter"
    activity_code: cht03
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - CHTNGO03 [# and] % of facilities submitted timely and complete
        HMIS reports to the MOH during the quarter
      formula: '100'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - CHTNGO03 [# and] % of facilities submitted timely and complete
        HMIS reports to the MOH during the quarter
      formula: '10'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - CHTNGO03 [# and] % of facilities submitted timely and
        complete HMIS reports to the MOH during the quarter
      formula:
      kind: data_element
      ext_id: ueS9vc91iof
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - CHTNGO03 [# and] % of facilities submitted timely and complete
        HMIS reports to the MOH during the quarter
      formula:
      kind: data_element
      ext_id: zHnGSAFeq9Y
  - !ruby/object:Orbf::RulesEngine::Activity
    name: "[# and %] of sampled facilities assessed to have implemented at least 80%
      of planned activities in updated business plan"
    activity_code: cht02
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - CHTNGO02 [# and %] of sampled facilities assessed to have
        implemented at least 80% of planned activities in updated business plan
      formula: '100'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - CHTNGO02 [# and %] of sampled facilities assessed to have
        implemented at least 80% of planned activities in updated business plan
      formula: '10'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - CHTNGO02 [# and %] of sampled facilities assessed to
        have implemented at least 80% of planned activities in updated business plan
      formula:
      kind: data_element
      ext_id: eWP2nzSi2h3
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - CHTNGO02 [# and %] of sampled facilities assessed to have
        implemented at least 80% of planned activities in updated business plan
      formula:
      kind: data_element
      ext_id: i2LovWO49dJ
  - !ruby/object:Orbf::RulesEngine::Activity
    name: Timely and complete quarterly financial and program reports submitted
    activity_code: cht05
    activity_states:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: target
      name: PBF - Target - CHTNGO05 Timely and complete quarterly financial and program
        reports submitted
      formula:
      kind: data_element
      ext_id: VQwClP1xXCc
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: achieved
      name: PBF - Achieved - CHTNGO05 Timely and complete quarterly financial and
        program reports submitted
      formula:
      kind: data_element
      ext_id: vsrb73Cnt1G
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: cap
      name: PBF - Cap - CHTNGO05 Timely and complete quarterly financial and program
        reports submitted
      formula: '100'
      kind: constant
      ext_id:
    - !ruby/object:Orbf::RulesEngine::ActivityState
      state: weight
      name: PBF - Weight - CHTNGO05 Timely and complete quarterly financial and program
        reports submitted
      formula: '10'
      kind: constant
      ext_id:
  kind: single
  code: cht_administrative_performance
  frequency: quarterly
  groupset_ext_id:
  dataset_ext_ids:
  - pnUFfNTUqef
  - uluG6r2h5Oe
  states: !ruby/object:Set
    hash:
      cap: true
      weight: true
      target: true
      achieved: true
payment_rules:
- !ruby/object:Orbf::RulesEngine::PaymentRule
  packages:
  - *8
  - *2
  - *5
  rule: &26 !ruby/object:Orbf::RulesEngine::Rule
    kind: payment
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: total_payment
      expression: quantity_quarter_total_amount + quality_quarter_total_amount
      comment: total_payment
      frequency:
      single_mapping: AHyQclhSAl4
      activity_mappings:
      rule: *26
    - !ruby/object:Orbf::RulesEngine::Formula
      code: quality_quarter_total_amount
      expression: qualtity_score * total_quality_budget
      comment: quality_quarter_total_amount
      frequency:
      single_mapping: nI6qaUve8sb
      activity_mappings:
      rule: *26
    - !ruby/object:Orbf::RulesEngine::Formula
      code: quantity_quarter_total_amount
      expression: quantity_total_amount
      comment: quantity_quarter_amount
      frequency:
      single_mapping: UXj0BJDXl7U
      activity_mappings:
      rule: *26
    decision_tables: []
  frequency: quarterly
  code: hospital_payment
- !ruby/object:Orbf::RulesEngine::PaymentRule
  packages:
  - *11
  - *19
  - *21
  rule: &27 !ruby/object:Orbf::RulesEngine::Rule
    kind: payment
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: dummy
      expression: '1'
      comment: dummy
      frequency:
      single_mapping:
      activity_mappings:
      rule: *27
      values_dependencies: []
    decision_tables: []
  frequency: quarterly
  code: hf_payment_rule
- !ruby/object:Orbf::RulesEngine::PaymentRule
  packages:
  - *24
  rule: &28 !ruby/object:Orbf::RulesEngine::Rule
    kind: payment
    formulas:
    - !ruby/object:Orbf::RulesEngine::Formula
      code: dummy
      expression: '1'
      comment: dummy
      frequency:
      single_mapping:
      activity_mappings:
      rule: *28
      values_dependencies: []
    decision_tables: []
  frequency: quarterly
  code: cht__payments
dhis2_params:
  :url: http://demo.org
  :user: fake
  :password: "unused"
  :no_ssl_verification: false
  :debug: false
default_category_option_combo_ext_id: wGxoultJedR
default_attribute_option_combo_ext_id: wGxoultJedR
engine_version: 3
